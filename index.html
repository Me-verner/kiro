<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Kiro Reset Clock</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
    <style>
        .eyes-container { display: flex; gap: 10px; }
        .eye {
            width: 60px;
            height: 60px;
            background-color: #0b0b0c;
            border-radius: 50%;
            position: relative;
            overflow: hidden;
            border: 2px solid #530f7f;
            animation: border-pulse 13s infinite;
        }
        @keyframes border-pulse {
            0% { border-color: #530f7f; }
            38.46% { border-color: #8b5cf6; }
            100% { border-color: #530f7f; }
        }
        .pupil {
            width: 23px;
            height: 17px;
            background-color: #7069a3;
            border-radius: 4px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            transition: height 0.2s ease-in-out;
        }
    </style>
</head>
<body class="bg-gray-900 text-white font-sans flex flex-col justify-center items-center min-h-screen m-0 overflow-hidden">
    <h1 class="text-3xl sm:text-4xl md:text-5xl font-bold mb-4 text-center pt-4">
        <span class="text-purple-400">Kiro</span>
        <span class="bg-white text-black px-2 rounded">Resets</span>
        <span class="text-purple-400">in:</span>
    </h1>
    <div id="countdown" class="text-6xl sm:text-7xl md:text-8xl font-extrabold tracking-widest text-green-400" style="text-shadow: 0 0 10px rgba(0,0,0,0.5)"></div>
    <canvas id="confetti-canvas" style="position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:9999;"></canvas>
    <div class="eyes-container" style="position:fixed;top:50px;left:50%;transform:translateX(-50%);z-index:10000;">
        <div class="eye"><div class="pupil"></div></div>
        <div class="eye"><div class="pupil"></div></div>
    </div>
    <br><br>
    <div class="text-lg sm:text-xl font-bold mb-2 text-gray-300">Hackathon submission deadline:</div>
    <div id="hackathon-countdown" class="text-2xl sm:text-3xl font-semibold text-blue-400"></div>
    <div class="text-lg sm:text-xl font-bold mb-2 text-gray-300 mt-4">Your local time:</div>
    <div id="local-time" class="text-2xl sm:text-3xl font-semibold text-yellow-400"></div>
    <div id="utc-offset" class="text-sm sm:text-base text-gray-400 mb-4"></div>
    <div class="text-lg sm:text-xl font-bold mb-2 text-gray-300">Your location:</div>
    <div id="location" class="text-2xl sm:text-3xl font-semibold text-yellow-400 mb-6"></div>
    <div class="absolute bottom-2 left-0 right-0 text-center text-gray-400">
        Made by <a href="https://t.me/me_verner" target="_blank" class="text-purple-400">T.me/me_verner</a>
    </div>
    <audio id="alarm-audio" preload="auto" style="display:none;">
        <source src="alarm.mp3" type="audio/mpeg"/>
    </audio>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const countdownEl = document.getElementById("countdown");
            const confettiCanvas = document.getElementById("confetti-canvas");
            const hackEl = document.getElementById("hackathon-countdown");
            const localEl = document.getElementById("local-time");
            const utcEl = document.getElementById("utc-offset");
            const locEl = document.getElementById("location");
            const alarmAudio = document.getElementById("alarm-audio");

            // Confetti setup
            const myConfetti = confetti.create(confettiCanvas, { resize: true, useWorker: true });
            function triggerConfetti(x = 0.5, y = 0.5) {
                myConfetti({
                    particleCount: 200, spread: 360, origin: { x, y }, scalar: 5.0,
                    shapes: ["circle", "square"],
                    colors: ["#a864fd", "#29cdff", "#78ff44", "#ff718d", "#fdff6a"]
                });
            }

            // Alarm logic
            const alarm = {
                audio: alarmAudio,
                triggered: false,
                play() {
                    this.audio.currentTime = 0;
                    this.audio.play().catch(() => {});
                    this.triggered = true;
                },
                reset() {
                    this.triggered = false;
                    this.audio.pause();
                    this.audio.currentTime = 0;
                }
            };

            // Resize confetti canvas
            function setCanvasSize() {
                confettiCanvas.width = window.innerWidth;
                confettiCanvas.height = window.innerHeight;
            }
            setCanvasSize();
            window.addEventListener("resize", setCanvasSize);

            // Countdown to next UTC midnight
            function getNextUTCMidnight() {
                const now = new Date();
                return new Date(Date.UTC(now.getUTCFullYear(), now.getUTCMonth(), now.getUTCDate() + 1, 0, 0, 0, 0));
            }

            function updateCountdown() {
                const now = new Date();
                let target = getNextUTCMidnight();
                if (now.getTime() >= target.getTime()) target = getNextUTCMidnight();
                const dist = target.getTime() - now.getTime();
                const secs = Math.floor(dist / 1000);
                if (secs === 309 && !alarm.triggered) alarm.play();
                if (secs > 309) alarm.reset();
                const hrs = Math.floor((dist % 86400000) / 3600000);
                const mins = Math.floor((dist % 3600000) / 60000);
                const s = Math.floor((dist % 60000) / 1000);
                const fmt = `${hrs.toString().padStart(2, "0")}:${mins.toString().padStart(2, "0")}:${s.toString().padStart(2, "0")}`;
                countdownEl.textContent = fmt;
                document.title = `ðŸ‘» ${fmt}`;
                if (dist < 0) {
                    countdownEl.textContent = "00:00:00";
                    triggerConfetti(); setTimeout(() => triggerConfetti(), 500); setTimeout(() => triggerConfetti(), 1000);
                }
            }
            updateCountdown(); setInterval(updateCountdown, 1000);

            // Hackathon countdown
            const hackTarget = new Date(Date.UTC(2025, 7, 25, 19, 0, 0));
            function updateHackathon() {
                const now = new Date();
                const dist = hackTarget.getTime() - now.getTime();
                if (dist < 0) {
                    hackEl.textContent = "Hackathon has started!";
                } else {
                    const days = Math.floor(dist / 86400000);
                    const hrs = Math.floor((dist % 86400000) / 3600000);
                    const mins = Math.floor((dist % 3600000) / 60000);
                    const s = Math.floor((dist % 60000) / 1000);
                    hackEl.textContent = `${days} days ${hrs.toString().padStart(2, "0")}:${mins.toString().padStart(2, "0")}:${s.toString().padStart(2, "0")}`;
                }
            }
            updateHackathon(); setInterval(updateHackathon, 1000);

            // Local time & UTC offset
            function updateLocal() {
                const now = new Date();
                localEl.textContent = now.toLocaleTimeString();
                const offsetMin = now.getTimezoneOffset();
                const offsetH = -offsetMin / 60;
                const sign = offsetH >= 0 ? "+" : "-";
                const absH = Math.floor(Math.abs(offsetH));
                const absM = Math.abs(offsetMin % 60);
                const offStr = `UTC${sign}${absH}` + (absM ? `:${absM.toString().padStart(2, "0")}` : "");
                utcEl.textContent = offStr + (offsetH > 0 ? " ahead of UTC" : offsetH < 0 ? " behind UTC" : " UTC");
            }
            updateLocal(); setInterval(updateLocal, 1000);

            // Fetch location (city, country)
            function updateLocation() {
                fetch("https://ipapi.co/json/")
                    .then(res => res.json())
                    .then(data => { locEl.textContent = `${data.city || "Unknown"}, ${data.country_name || "Unknown"}`; })
                    .catch(() => { locEl.textContent = "Location unavailable"; });
            }
            updateLocation();

            // Eye animation
            let eyes = document.querySelectorAll(".eye");
            let pendActive = true, pendId;
            function animatePendulum() {
                if (!pendActive) return;
                const now = new Date(), t = ((now.getSeconds() % 2) + now.getMilliseconds() / 1000) / 2;
                const ang = Math.sin(t * Math.PI * 2 - Math.PI / 2);
                const px = ang * 18;
                const py = 8 + Math.abs(ang) * 8;
                eyes.forEach(eye => eye.querySelector(".pupil").style.transform = `translate(-50%,-50%) translate(${px}px,${py}px)`);
                pendId = requestAnimationFrame(animatePendulum);
            }
            function blinkEyes() {
                eyes.forEach(eye => {
                    const p = eye.querySelector(".pupil");
                    p.style.height = "4px";
                    setTimeout(() => p.style.height = "17px", 100);
                });
            }
            function startBlinking() {
                setTimeout(() => {
                    blinkEyes();
                    if (Math.random() < 0.3) setTimeout(blinkEyes, 200);
                    startBlinking();
                }, Math.random() * (5000 - 3000) + 3000);
            }
            startBlinking(); animatePendulum();
            eyes.forEach(eye => eye.querySelector(".pupil").addEventListener("click", blinkEyes));

            // Mouse eye follow
            let mouseTimeout;
            document.addEventListener("mousemove", event => {
                pendActive = false;
                if (pendId) cancelAnimationFrame(pendId);
                clearTimeout(mouseTimeout);
                eyes.forEach(eye => {
                    const p = eye.querySelector(".pupil");
                    const r = eye.getBoundingClientRect();
                    const dx = event.clientX - (r.left + r.width / 2);
                    const dy = event.clientY - (r.top + r.height / 2);
                    const dist = Math.min(r.width / 4, Math.hypot(dx, dy));
                    const ang = Math.atan2(dy, dx);
                    p.style.transform = `translate(-50%,-50%) translate(${dist * Math.cos(ang)}px,${dist * Math.sin(ang)}px)`;
                });
                mouseTimeout = setTimeout(() => { pendActive = true; animatePendulum(); }, 3000);
            });
        });
    </script>
</body>
</html>
